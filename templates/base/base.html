{% load static %}

<!DOCTYPE html>
<html lang="en">
<link>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Vibebox || {% block title %}{% endblock %}</title>
    <link rel="stylesheet" href={% static '/css/base.css' %}></link>
    {% block extra_css %}{% endblock %}
</head>

<body>
    <div class="background-animation"></div>
    <div id="toast-container"></div>

    <nav class="navbar">

        <div class="nav-container">
            <div class="logo">
                <div class="logo-icon">üéµ</div>
                <span>Vibebox</span>
            </div>
            <div class="nav-menu">
                <a href="/" class="nav-item active">Home</a>
                <a href={% url 'saved_track' %} class="nav-item">My Tracks</a>
                <a href="/me/library/" class="nav-item">Library</a>
                <a href="/search/" class="nav-item">Search</a>
            </div>
            <div class="user-menu">
                <div class="user-avatar">
                    <img id="userAvatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%231db954'%3E%3Cpath d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z'/%3E%3C/svg%3E" alt="User" />
                </div>
                <button class="menu-toggle" onclick="toggleUserMenu()">‚ãÆ</button>

                <div class="user-dropdown hidden" id="userDropdown">
                    <p id="loadingText">Loading profile...</p>
                    <div id="userInfo" style="display: flex; flex-direction: column; gap: 10px;" class="hidden">
                        <p><strong>Name:</strong> <span id="userName"></span></p>
                        <p><strong>Email:</strong> <span id="userEmail"></span></p>
                        <p><strong>Country:</strong> <span id="userCountry"></span></p>
                        <p><strong>Plan:</strong> <span id="userPlan"></span></p>
                        <p><strong>Followers:</strong> <span id="userFollowers"></span></p>
                        <a id="spotifyLink" href="#" target="_blank">View on Spotify</a>
                        {% if user.is_authenticated %}
                            <a id="logout" href={% url 'logout' %}>
                                <button class="cssbuttons-io">
                                <span
                                    ><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M0 0h24v24H0z" fill="none"></path>
                                    <path
                                        d="M24 12l-5.657 5.657-1.414-1.414L21.172 12l-4.243-4.243 1.414-1.414L24 12zM2.828 12l4.243 4.243-1.414 1.414L0 12l5.657-5.657L7.07 7.757 2.828 12zm6.96 9H7.66l6.552-18h2.128L9.788 21z"
                                        fill="currentColor"
                                    ></path>
                                    </svg>
                                        Logout
                                    </span
                                >
                                </button>

                            </a>
                        {% endif %}
                        
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div style="padding-top: 90px; padding-left: 10px;" class="go-back">
        <button class="back-button" id="gobackbtn">
            ‚Üê Back to Playlists
        </button>
    </div>


    <main style="margin-bottom: 140px;">
        {% block content %}{% endblock %}
    </main>


    <div class="player-controls" id="playerControls">
        <div class="now-playing">
            <img id="nowPlayingImage" draggable="false" src={% static '/assets/images/spotify-icon.webp' %} alt="Now Playing">
            <div class="track-info-small">
                <div class="track-name-small" id="nowPlayingName">Not playing</div>
                <div class="track-artist-small" id="nowPlayingArtist">Vibebox</div>
            </div>
        </div>
            
        <div class="playback-controls">
            <button title="previous" class="control-button" onclick="previousTrack()">
                <svg viewBox="0 0 24 24" width="24" height="24">
                    <path fill="currentColor" d="M6 6h2v12H6zm3.5 6l8.5 6V6z"></path>
                </svg>
            </button>

            <button title="play" class="control-button play-pause" id="playPauseBtn">
                <svg viewBox="0 0 24 24" width="16" height="16" id="playPauseIcon">
                    <path fill="currentColor" d="M8 5v14l11-7z"></path>
                </svg>
            </button>

            <button title="next" class="control-button" onclick="nextTrack()">
                <svg viewBox="0 0 24 24" width="24" height="24">
                    <path fill="currentColor" d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"></path>
                </svg>
            </button>
        </div>
            
        <div class="playback-bar">
            <span class="progress-time" id="currentTime">0:00</span>
            <div class="progress-bar" onclick="seek(event)">
                <div class="progress" id="progress"></div>
            </div>
            <span class="progress-time" id="totalTime">0:00</span>
        </div>
    </div>

    <script type="module" src="{% static 'js/base.js' %}"></script>
    <script type="module" src="{% static 'js/home/track.js' %}"></script>
    {% block extra_js %}{% endblock %}
</body>
</html>
